---
import { getCollection } from "astro:content"
const services = await getCollection("services")
---

<div class='images-container'>
  {
    services.map((service) => (
      <div class='image' data-status={service.data.dataState} data-item={service.data.dataItem}>
        <img class='service-img' src={service.data.image} />
        <h3>{service.data.name}</h3>
        <p>{service.data.description}</p>
      </div>
    ))
  }
</div>

<script>
  const buttonItems: NodeListOf<HTMLButtonElement> = document.querySelectorAll(".button-item")

  const images: NodeListOf<HTMLDivElement> = document.querySelectorAll(".image")

  buttonItems.forEach((button) => {
    button.addEventListener("click", () => {
      images.forEach((image) => {
        if (button.getAttribute("id") !== image.getAttribute("data-item")) {
          image.classList.remove("anime-fade-in-image")
          image.classList.add("anime-fade-out-image")

          setTimeout(() => {
            image.setAttribute("data-status", "inactive")
          }, 300)
        }

        if (button.getAttribute("data-item") === image.getAttribute("data-item")) {
          image.classList.remove("anime-fade-out-image")
          setTimeout(() => {
            image.classList.add("anime-fade-in-image")
            image.setAttribute("data-status", "active")
          }, 300)
        }
      })
    })
  })
</script>
